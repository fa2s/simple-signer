class Signer{constructor(t){if(!t)throw"Need an API KEY";this.api_key=t}static modes=["development","staging","production"];static endpoints={staging:"https://staging.fa2s.com.br/api/envelopes",production:"https://signer.fa2s.com.br/api/envelopes"};static#n={read_and_accept:"Li e aceito ",accept:"Eu aceito ",agree:"Concordo com "};static texts(){return this.#n}#o=!1;#e="production";#s=null;#t=[];#c=null;#i="agree";toggle=()=>{};set text(t){this.#i=t}set set(t){this.#c=t}get mode(){return this.#e}set mode(t){if(this.constructor.modes.includes(t))this.#e=t;else throw"Unknown mode"}get contents(){return this.#t}set contents(t){if(Array.isArray(t))this.#t=t;else throw"Contents muts be an array"}get endpoint(){return this.#s??this.constructor.endpoints[this.#e]}set endpoint(t){this.#s=t}mount(t){const i=this;if(!this.#t.length)throw"Contents cannot be empty";const a=document.querySelector(t).attachShadow({mode:"closed"}),n=document.createElement("label"),r=document.createElement("input");r.type="checkbox",r.addEventListener("change",e=>{this.#o=e.target.checked,this.toggle(e.target.checked)}),n.append(r);const d=document.createTextNode(this.constructor.#n[this.#i]);n.append(d);const s=this.#t.map(({url:e,name:o})=>{const c=document.createElement("a");return c.text=o,c.href=e,c.target="_blank",c});switch(s.length){default:s.slice(0,-2).forEach(e=>{const o=document.createTextNode(", ");n.append(e),n.append(o)});case 2:s.slice(-2,-1).forEach(e=>{const o=document.createTextNode(" e ");n.append(e),n.append(o)});case 1:s.slice(-1).forEach(e=>{n.append(e)})}a.append(n)}agree(){if(!this.#o)throw"Trying to force agreement";const t={method:"POST",headers:{Authorization:`ApiKey ${this.api_key}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({envelope:{signer:this.#c,contents:this.#t}})};return fetch(this.endpoint,t).then(i=>Promise[i.ok?"resolve":"reject"](i))}}
